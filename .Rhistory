rmse_lm <- RMSE(predictions_lm, test_data$Rings)
r2_lm <- R2(predictions_lm, test_data$Rings)
cat("RF RMSE:", rmse_rf, "R2:", r2_rf, "\n")
cat("SVM RMSE:", rmse_svm, "R2:", r2_svm, "\n")
cat("GBM RMSE:", rmse_gbm, "R2:", r2_gbm, "\n")
cat("LM RMSE:", rmse_lm, "R2:", r2_lm, "\n")
train_control <- trainControl(method = "cv", number = 10, search = "grid")
tune_grid <- expand.grid(
mtry = seq(2, ncol(abalone_no_sex) - 1, by = 1),
splitrule = c("variance"),
min.node.size = c(5, 10)
)
set.seed(12)
tuned_model <- train(Rings ~ ., data = abalone_no_sex, method = "ranger",
trControl = train_control, tuneGrid = tune_grid,
metric = "RMSE")
library(caret)
install.packages("FactoMineR")
library(FactoMineR)
abalone_pca = abalone_no_sex[, !names(abalone) %in% c("Rings")]
abalone_pca = abalone_no_sex[, !names(abalone) %in% c("Rings")]
abalone_no_sex =abalone[, !names(abalone) %in% c("Sex")]
abalone_pca = abalone_no_sex[, !names(abalone) %in% c("Rings")]
abalone_pca = abalone_no_sex[, !names(abalone) %in% c("Rings")]
abalone_no_sex =abalone[, !names(abalone) %in% c("Sex")]
abalone_pca = abalone_no_sex[, !names(abalone_no_sex) %in% c("Rings")]
library(caret)
library(FactoMineR)
abalone_no_sex =abalone[, !names(abalone) %in% c("Sex")]
abalone_pca = abalone_no_sex[, !names(abalone_no_sex) %in% c("Rings")]
data = abalone_pca
data_scaled = scale(data)
print(data)
abalone = read.csv("/Users/sriyapothula/Desktop/stat/Abalone/abalone.csv")
sum(is.na(abalone))
sum(complete.cases(abalone))
library(tidyverse)
library(dplyr)
library(ggplot2)
library(GGally)
ggpairs(abalone, aes(colour = Sex, alpha = 0.8), title="Pairs plot for abalone dataset") +
theme_grey(base_size = 8)
library(tidyverse)
library(randomForest)
library(caret)
library(corrplot)
ggplot(abalone, aes(x = Rings)) +
geom_histogram(binwidth = 1, fill = "blue", color = "black") +
labs(title = "Distribution of Rings")
ggplot(abalone, aes(x = Sex, y = Rings)) +
geom_boxplot(fill = "cyan", color = "black") +
labs(title = "Rings Distribution by Sex")
pairs(~Length + Diameter + Height + Whole_weight, data = abalone,
main = "Pairwise Relationships", pch = 20)
anova_result <- aov(Rings ~ Sex, data = abalone)
summary(anova_result)
#abalone$Sex <- as.factor(abalone$Sex)
#correlations <- cor(abalone[,-1])
#correlations
abalone$Sex <- as.factor(abalone$Sex)
correlations <- cor(abalone[,-1])
correlations
set.seed(12)
model <- randomForest(Rings ~ ., data = abalone, importance = TRUE)
varImpPlot(model)
abalone_no_sex <- abalone[, !names(abalone) %in% c("Sex")]
index <- createDataPartition(abalone_no_sex$Rings, p = 0.8, list = TRUE)
train_data <- abalone_no_sex[index$Resample1,]
test_data <- abalone_no_sex[-index$Resample1,]
train_control <- trainControl(
method = "cv",
number = 10
)
models <- list()
models$rf <- train(Rings ~ ., data = abalone_no_sex, method = "rf", trControl = train_control)
models$svm <- train(Rings ~ ., data = abalone_no_sex, method = "svmRadial", trControl = train_control, preProcess = "scale")
# GBM
models$gbm <- train(Rings ~ ., data = abalone_no_sex, method = "gbm", trControl = train_control, verbose = FALSE)
# Linear Regression
models$lm <- train(Rings ~ ., data = abalone_no_sex, method = "lm", trControl = train_control)
predictions_rf <- predict(models$rf, test_data)
predictions_svm <- predict(models$svm, test_data)
predictions_gbm <- predict(models$gbm, test_data)
predictions_lm <- predict(models$lm, test_data)
rmse_rf <- RMSE(predictions_rf, test_data$Rings)
r2_rf <- R2(predictions_rf, test_data$Rings)
rmse_svm <- RMSE(predictions_svm, test_data$Rings)
r2_svm <- R2(predictions_svm, test_data$Rings)
rmse_gbm <- RMSE(predictions_gbm, test_data$Rings)
r2_gbm <- R2(predictions_gbm, test_data$Rings)
rmse_lm <- RMSE(predictions_lm, test_data$Rings)
r2_lm <- R2(predictions_lm, test_data$Rings)
cat("RF RMSE:", rmse_rf, "R2:", r2_rf, "\n")
cat("SVM RMSE:", rmse_svm, "R2:", r2_svm, "\n")
cat("GBM RMSE:", rmse_gbm, "R2:", r2_gbm, "\n")
cat("LM RMSE:", rmse_lm, "R2:", r2_lm, "\n")
train_control <- trainControl(method = "cv", number = 10, search = "grid")
tune_grid <- expand.grid(
mtry = seq(2, ncol(abalone_no_sex) - 1, by = 1),
splitrule = c("variance"),
min.node.size = c(5, 10)
)
set.seed(12)
tuned_model <- train(Rings ~ ., data = abalone_no_sex, method = "ranger",
trControl = train_control, tuneGrid = tune_grid,
metric = "RMSE")
library(caret)
library(FactoMineR)
abalone_no_sex =abalone[, !names(abalone) %in% c("Sex")]
abalone_pca = abalone_no_sex[, !names(abalone_no_sex) %in% c("Rings")]
data = abalone_pca
data_scaled = scale(data)
pca_result = PCA(data_scaled, graph = FALSE)
plot(pca_result, choice = "eigen")
num_components = which(cumsum(pca_result$eig[,2]) > 85)[1]
data_pca = pca_result$ind$coord[, 1:num_components]
num_components = which(cumsum(pca_result$eig[,2]) > 85)[1]
data_pca = pca_result$ind$coord[, 1:num_components]
final_data = data.frame(Rings = abalone_pca$Rings, data_pca)
final_data = data.frame(Rings = abalone_pca$Rings, data_pca)
plot(pca_result, choice = "eigen")
num_components = which(cumsum(pca_result$eig[,2]) > 85)[1]
data_pca = pca_result$ind$coord[, 1:num_components]
num_components = which(cumsum(pca_result$eig[,2]) > 85)[1]
data_pca = pca_result$ind$coord[, 1:num_components]
final_data = data.frame(Rings = abalone_pca$Rings, data_pca)
library(caret)
library(FactoMineR)
#abalone_no_sex =abalone[, !names(abalone) %in% c("Sex")]
abalone_pca = abalone_no_sex[, !names(abalone_no_sex) %in% c("Rings")]
data = abalone_pca
data_scaled = scale(data)
pca_result = PCA(data_scaled, graph = FALSE)
plot(pca_result, choice = "eigen")
num_components = which(cumsum(pca_result$eig[,2]) > 85)[1]
data_pca = pca_result$ind$coord[, 1:num_components]
num_components = which(cumsum(pca_result$eig[,2]) > 85)[1]
data_pca = pca_result$ind$coord[, 1:num_components]
final_data = data.frame(Rings = abalone_pca$Rings, data_pca)
library(caret)
library(FactoMineR)
#abalone_no_sex =abalone[, !names(abalone) %in% c("Sex")]
abalone_pca = abalone_no_sex[, !names(abalone) %in% c("Rings")]
data = abalone_pca
data_scaled = scale(data)
pca_result = PCA(data_scaled, graph = FALSE)
plot(pca_result, choice = "eigen")
num_components = which(cumsum(pca_result$eig[,2]) > 85)[1]
data_pca = pca_result$ind$coord[, 1:num_components]
num_components = which(cumsum(pca_result$eig[,2]) > 85)[1]
data_pca = pca_result$ind$coord[, 1:num_components]
final_data = data.frame(Rings = abalone_pca$Rings, data_pca)
set.seed(12)
index = createDataPartition(final_data$Rings, p = 0.8, list = TRUE)
train_data_pca = final_data[index$Resample1,]
test_data_pca = final_data[-index$Resample1,]
train_control_pca = trainControl(method = "cv", number = 10)
models_pca = list()
models_pca$rf = train(Rings ~ ., data = train_data_pca, method = "rf", trControl = train_control_pca)
models_pca$svm = train(Rings ~ ., data = train_data_pca, method = "svmRadial", trControl = train_control_pca)
models_pca$gbm = train(Rings ~ ., data = train_data_pca, method = "gbm", trControl = train_control_pca, verbose = FALSE)
# Linear Regression
models_pca$lm <- train(Rings ~ ., data = train_data_pca, method = "lm", trControl = train_control_pca)
predictions_rf_pca = predict(models_pca$rf, test_data_pca)
predictions_svm_pca = predict(models_pca$svm, test_data_pca)
predictions_gbm_pca = predict(models_pca$gbm, test_data_pca)
predictions_lm_pca = predict(models_pca$lm, test_data_pca)
rmse_rf_pca = RMSE(predictions_rf_pca, test_data_pca$Rings)
r2_rf_pca = R2(predictions_rf_pca, test_data_pca$Rings)
rmse_svm_pca = RMSE(predictions_svm_pca, test_data_pca$Rings)
r2_svm_pca = R2(predictions_svm_pca, test_data_pca$Rings)
rmse_gbm_pca = RMSE(predictions_gbm_pca, test_data_pca$Rings)
r2_gbm_pca = R2(predictions_gbm_pca, test_data_pca$Rings)
rmse_lm_pca = RMSE(predictions_lm_pca, test_data_pca$Rings)
r2_lm_pca = R2(predictions_lm_pca, test_data_pca$Rings)
cat("RF RMSE:", rmse_rf_pca, "R2:", r2_rf_pca, "\n")
cat("SVM RMSE:", rmse_svm_pca, "R2:", r2_svm_pca, "\n")
cat("GBM RMSE:", rmse_gbm_pca, "R2:", r2_gbm_pca, "\n")
cat("LM RMSE:", rmse_lm_pca, "R2:", r2_lm_pca, "\n")
library(shiny)
ui = fluidPage(
titlePanel("Abalone Age Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("length", "Length"),
numericInput("diameter", "Diameter"),
numericInput("height", "Height"),
numericInput("whole_weight", "Whole Weight"),
numericInput("shucked_weight", "Shucked Weight"),
numericInput("viscera_weight", "Viscera Weight"),
numericInput("shell_weight", "Shell Weight"),
actionButton("predict", "Predict Age")
),
mainPanel(
textOutput("age_prediction")
)
)
)
library(shiny)
ui = fluidPage(
titlePanel("Abalone Age Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("length", "Length"),
numericInput("diameter", "Diameter"),
numericInput("height", "Height"),
numericInput("whole_weight", "Whole Weight"),
numericInput("shucked_weight", "Shucked Weight"),
numericInput("viscera_weight", "Viscera Weight"),
numericInput("shell_weight", "Shell Weight"),
actionButton("predict", "Predict Age")
),
mainPanel(
textOutput("age_prediction")
)
)
)
library(dplyr)
library(caret)
library(pROC)
abalone$Mature <- if_else(abalone$Rings >= 10, "mature", "immature")
abalone$Sex <- as.factor(abalone$Sex)
set.seed(12)
index <- createDataPartition(abalone$Mature, p = 0.8, list = TRUE)
train_data <- abalone[index[[1]], ]
test_data <- abalone[-index[[1]], ]
train_data$Mature <- as.integer(train_data$Mature == "mature")
model_log <- glm(Mature ~ . -Rings, data = train_data, family = binomial())
predictions_log <- predict(model_log, test_data, type = "response")
predicted_classes_log <- if_else(predictions_log > 0.5, "mature", "immature")
predicted_classes_log <- factor(predicted_classes_log, levels = c("immature", "mature"))
test_data$Mature <- factor(test_data$Mature, levels = c("immature", "mature"))
confusion_matrix <- confusionMatrix(predicted_classes_log, test_data$Mature)
roc_curve <- roc(test_data$Mature, predictions_log)
plot(roc_curve, main = "ROC Curve for Logistic Regression")
library(shiny)
ui = fluidPage(
titlePanel("Abalone Age Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("length", "Length", value = 0.5),
numericInput("diameter", "Diameter", value = 0.4),
numericInput("height", "Height", value = 0.1),
numericInput("whole_weight", "Whole Weight", value = 0.5),
numericInput("shucked_weight", "Shucked Weight", value = 0.2),
numericInput("viscera_weight", "Viscera Weight", value = 0.1),
numericInput("shell_weight", "Shell Weight", value = 0.15),
actionButton("predict", "Predict Age")
),
mainPanel(
textOutput("age_prediction")
)
)
)
server = function(input, output) {
observeEvent(input$predict, {
new_data = data.frame(
Length = input$length,
Diameter = input$diameter,
Height = input$height,
Whole_weight = input$whole_weight,
Shucked_weight = input$shucked_weight,
Viscera_weight = input$viscera_weight,
Shell_weight = input$shell_weight
)
predicted_age <- predict(models$rf, new_data)
output$age_prediction <- renderText({
paste("Predicted age:", round(predicted_age))
})
})
}
shinyApp(ui = ui, server = server)
glimpse(abalone)
abalone_m <- abalone %>% filter(Sex == 'M')
abalone_f <- abalone %>% filter(Sex == 'F')
abalone_i <- abalone %>% filter(Sex == 'I')
library(caret)
set.seed(123)
trainIndex_m <- createDataPartition(abalone_m$Rings, p = 0.8, list = FALSE)
train_m <- abalone_m[trainIndex_m, ]
test_m <- abalone_m[-trainIndex_m, ]
trainIndex_f <- createDataPartition(abalone_f$Rings, p = 0.8, list = FALSE)
train_f <- abalone_f[trainIndex_f, ]
test_f <- abalone_f[-trainIndex_f, ]
trainIndex_i <- createDataPartition(abalone_i$Rings, p = 0.8, list = FALSE)
train_i <- abalone_i[trainIndex_i, ]
test_i <- abalone_i[-trainIndex_i, ]
library(randomForest)
model_m <- randomForest(Rings ~ . -Sex, data = train_m)
model_f <- randomForest(Rings ~ . -Sex, data = train_f)
model_i <- randomForest(Rings ~ . -Sex, data = train_i)
predictions_m <- predict(model_m, test_m)
rmse_m <- sqrt(mean((predictions_m - test_m$Rings)^2))
r2_m <- cor(predictions_m, test_m$Rings)^2
predictions_f <- predict(model_f, test_f)
rmse_f <- sqrt(mean((predictions_f - test_f$Rings)^2))
r2_f <- cor(predictions_f, test_f$Rings)^2
predictions_i <- predict(model_i, test_i)
rmse_i <- sqrt(mean((predictions_i - test_i$Rings)^2))
r2_i <- cor(predictions_i, test_i$Rings)^2
cat("Male RMSE:", rmse_m, "R²:", r2_m, "\n")
cat("Female RMSE:", rmse_f, "R²:", r2_f, "\n")
cat("Infant RMSE:", rmse_i, "R²:", r2_i, "\n")
library(gridExtra)
library(tidyverse)
set.seed(42)
indexes <- sample(1:nrow(abalone), size = 0.3 * nrow(abalone))
abalone_train <- abalone[-indexes,]
abalone_test <- abalone[indexes,]
par(mfrow = c(3, 3),oma=c(0,0,0,0))
create_scatter_plot <- function(xvar,yvar,xtitle,ytitle) {
ggplot(abalone_train,aes(x=xvar,y=yvar, col=Sex)) +
geom_point() +
geom_jitter() +
xlab(paste(xtitle)) +
ylab(paste(ytitle))
}
grid.arrange(
create_scatter_plot(abalone_train$Length,abalone_train$Rings,"Length","Rings"),
create_scatter_plot(abalone_train$Diameter,abalone_train$Rings,"Diameter","Rings"),
create_scatter_plot(abalone_train$Height,abalone_train$Rings,"Height","Rings"),
create_scatter_plot(abalone_train$Whole_weight,abalone_train$Rings,"Whole_weight","Rings"),
create_scatter_plot(abalone_train$Shell_weight,abalone_train$Rings,"Shell_weight","Rings"),
create_scatter_plot(abalone_train$Shucked_weight,abalone_train$Rings,"Shucked_weight","Rings"),
create_scatter_plot(abalone_train$Viscera_weight,abalone_train$Rings,"Viscera_weight","Rings")
)
library(shiny)
ui = fluidPage(
titlePanel("Abalone Age Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("length", "Length", value = 0.5),
numericInput("diameter", "Diameter", value = 0.4),
numericInput("height", "Height", value = 0.1),
numericInput("whole_weight", "Whole Weight", value = 0.5),
numericInput("shucked_weight", "Shucked Weight", value = 0.2),
numericInput("viscera_weight", "Viscera Weight", value = 0.1),
numericInput("shell_weight", "Shell Weight", value = 0.15),
actionButton("predict", "Predict Age")
),
mainPanel(
textOutput("age_prediction")
)
)
)
server = function(input, output) {
observeEvent(input$predict, {
new_data = data.frame(
Length = input$length,
Diameter = input$diameter,
Height = input$height,
Whole_weight = input$whole_weight,
Shucked_weight = input$shucked_weight,
Viscera_weight = input$viscera_weight,
Shell_weight = input$shell_weight
)
predicted_age <- predict(models$rf, new_data)
output$age_prediction <- renderText({
paste("Predicted age:", round(predicted_age))
})
})
}
shinyApp(ui = ui, server = server)
library(shiny)
ui = fluidPage(
titlePanel("Abalone Age Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("length", "Length", value = 0.5),
numericInput("diameter", "Diameter", value = 0.4),
numericInput("height", "Height", value = 0.1),
numericInput("whole_weight", "Whole Weight", value = 0.5),
numericInput("shucked_weight", "Shucked Weight", value = 0.2),
numericInput("viscera_weight", "Viscera Weight", value = 0.1),
numericInput("shell_weight", "Shell Weight", value = 0.15),
actionButton("predict", "Predict Age")
),
mainPanel(
textOutput("age_prediction")
)
)
)
server = function(input, output) {
observeEvent(input$predict, {
new_data = data.frame(
Length = input$length,
Diameter = input$diameter,
Height = input$height,
Whole_weight = input$whole_weight,
Shucked_weight = input$shucked_weight,
Viscera_weight = input$viscera_weight,
Shell_weight = input$shell_weight
)
predicted_age <- predict(models$rf, new_data)
output$age_prediction <- renderText({
paste("Predicted age:", round(predicted_age))
})
})
}
shinyApp(ui = ui, server = server)
library(shiny)
ui = fluidPage(
titlePanel("Abalone Age Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("length", "Length", value = 0.5),
numericInput("diameter", "Diameter", value = 0.4),
numericInput("height", "Height", value = 0.1),
numericInput("whole_weight", "Whole Weight", value = 0.5),
numericInput("shucked_weight", "Shucked Weight", value = 0.2),
numericInput("viscera_weight", "Viscera Weight", value = 0.1),
numericInput("shell_weight", "Shell Weight", value = 0.15),
actionButton("predict", "Predict Age")
),
mainPanel(
textOutput("age_prediction")
)
)
)
server = function(input, output) {
observeEvent(input$predict, {
new_data = data.frame(
Length = input$length,
Diameter = input$diameter,
Height = input$height,
Whole_weight = input$whole_weight,
Shucked_weight = input$shucked_weight,
Viscera_weight = input$viscera_weight,
Shell_weight = input$shell_weight
)
predicted_age <- predict(models$rf, new_data)
output$age_prediction <- renderText({
paste("Predicted age:", round(predicted_age))
})
})
}
shinyApp(ui = ui, server = server)
library(shiny)
ui = fluidPage(
titlePanel("Abalone Age Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("length", "Length", value = 0.5),
numericInput("diameter", "Diameter", value = 0.4),
numericInput("height", "Height", value = 0.1),
numericInput("whole_weight", "Whole Weight", value = 0.5),
numericInput("shucked_weight", "Shucked Weight", value = 0.2),
numericInput("viscera_weight", "Viscera Weight", value = 0.1),
numericInput("shell_weight", "Shell Weight", value = 0.15),
actionButton("predict", "Predict Age")
),
mainPanel(
textOutput("age_prediction")
)
)
)
server = function(input, output) {
observeEvent(input$predict, {
new_data = data.frame(
Length = input$length,
Diameter = input$diameter,
Height = input$height,
Whole_weight = input$whole_weight,
Shucked_weight = input$shucked_weight,
Viscera_weight = input$viscera_weight,
Shell_weight = input$shell_weight
)
predicted_age <- predict(models$rf, new_data)
output$age_prediction <- renderText({
paste("Predicted age:", round(predicted_age))
})
})
}
shiny(ui = ui, server = server)
library(shiny)
ui = fluidPage(
titlePanel("Abalone Age Prediction"),
sidebarLayout(
sidebarPanel(
numericInput("length", "Length", value = 0.5),
numericInput("diameter", "Diameter", value = 0.4),
numericInput("height", "Height", value = 0.1),
numericInput("whole_weight", "Whole Weight", value = 0.5),
numericInput("shucked_weight", "Shucked Weight", value = 0.2),
numericInput("viscera_weight", "Viscera Weight", value = 0.1),
numericInput("shell_weight", "Shell Weight", value = 0.15),
actionButton("predict", "Predict Age")
),
mainPanel(
textOutput("age_prediction")
)
)
)
server = function(input, output) {
observeEvent(input$predict, {
new_data = data.frame(
Length = input$length,
Diameter = input$diameter,
Height = input$height,
Whole_weight = input$whole_weight,
Shucked_weight = input$shucked_weight,
Viscera_weight = input$viscera_weight,
Shell_weight = input$shell_weight
)
predicted_age <- predict(models$rf, new_data)
output$age_prediction <- renderText({
paste("Predicted age:", round(predicted_age))
})
})
}
shinyApp(ui = ui, server = server)
runApp('~/Desktop/web.R')
